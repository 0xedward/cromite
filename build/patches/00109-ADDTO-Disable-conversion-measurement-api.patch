From: Your Name <you@example.com>
Date: Thu, 5 Jan 2023 11:33:47 +0000
Subject: 109 ADDTO Disable conversion measurement api

---
 .../attribution_report_network_sender.cc                  | 8 ++++++--
 content/renderer/render_thread_impl.cc                    | 2 +-
 2 files changed, 7 insertions(+), 3 deletions(-)

diff --git a/content/browser/attribution_reporting/attribution_report_network_sender.cc b/content/browser/attribution_reporting/attribution_report_network_sender.cc
--- a/content/browser/attribution_reporting/attribution_report_network_sender.cc
+++ b/content/browser/attribution_reporting/attribution_report_network_sender.cc
@@ -83,6 +83,9 @@ void AttributionReportNetworkSender::SendReport(GURL url,
                                                 const std::string& body,
                                                 net::HttpRequestHeaders headers,
                                                 UrlLoaderCallback callback) {
+  // this is never called on Bromite but nothing would be sent if it were
+  if ((true)) return;
+
   auto resource_request = std::make_unique<network::ResourceRequest>();
   resource_request->url = std::move(url);
   resource_request->headers = std::move(headers);
@@ -143,8 +146,9 @@ void AttributionReportNetworkSender::SendReport(GURL url,
                    network::SimpleURLLoader::RETRY_ON_NAME_NOT_RESOLVED;
   simple_url_loader_ptr->SetRetryOptions(/*max_retries=*/1, retry_mode);
 
-  // this is never called on Bromite but nothing would be sent if it were
-  OnReportSent(std::move(it), report, is_debug_report, std::move(sent_callback), nullptr);
+  simple_url_loader_ptr->DownloadHeadersOnly(
+      url_loader_factory_.get(),
+      base::BindOnce(std::move(callback), std::move(it)));
 }
 
 void AttributionReportNetworkSender::OnReportSent(
diff --git a/content/renderer/render_thread_impl.cc b/content/renderer/render_thread_impl.cc
--- a/content/renderer/render_thread_impl.cc
+++ b/content/renderer/render_thread_impl.cc
@@ -1853,7 +1853,7 @@ RenderThreadImpl::GetOsSupportForAttributionReporting() {
 
 void RenderThreadImpl::SetOsSupportForAttributionReporting(
     attribution_reporting::mojom::OsSupport attribution_os_support) {
-  attribution_os_support_ = attribution_os_support;
+  attribution_os_support_ = attribution_reporting::mojom::OsSupport::kDisabled;
 }
 
 std::unique_ptr<CodecFactory> RenderThreadImpl::CreateMediaCodecFactory(
--
2.25.1
